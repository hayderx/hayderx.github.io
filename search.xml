<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Saltstack]]></title>
    <url>%2F2019%2F07%2F29%2FSaltstack%2F</url>
    <content type="text"><![CDATA[Saltstack介绍 特点： 基于Python的C/S架构配置管理工具。 底层使用ZeroMQ消息队列pub/sub方式通信。 使用SSL证书签发的方式进行认证管理，传输采用AES加密。 服务架构： 在saltstack架构中服务端叫Master，客户端叫Minion。在Master和Minion段都是以守护进程的模式运行，一直监听配置文件里定义的ret_port(接受minion请求)和publish_port(发布消息)的端口。当Minion运行时会自动链接到配置文件里定义的Master地址ret_port端口进行连接认证。 运行方式： local： 本地运行 Master/Minion：传统方式 Syndic： 分布式 Salt ssh 组件介绍： 组件 功能 Salt Master 用于将命令和配置发送到在受管系统上运行的Salt minion Salt Minion 从Salt master接收命令和配置 Execution Modules 实时监控，状态和库存；一次性命令和脚本；部署关键更新 Formulas (States) 系统配置的声明性或命令式表示 Grains Grains是有关底层受管系统的静态信息，包括操作系统，内存和许多其他系统属性。 Runners 在Salt master上执行的模块，用于执行支持任务。Salt runners报告作业状态，连接状态，从外部API读取数据，查询连接的Salt minions等。 Returners 将Salt minions返回的数据发送到另一个系统，例如数据库。Salt Returners可以在Salt minion或Salt master上运行。 Reactor 在SaltStack环境中发生事件时触发反应。 Salt SSH 在没有Salt minion的系统上通过SSH运行Salt命令。 SaltStack安装 ip 组件 192.168.111.43 salt salt-cloud salt-master salt-minion salt-ssh salt-syndic 192.168.111.45 salt-minion 1. 配置yum源 123rpm -ivh https://repo.saltstack.com/yum/redhat/salt-repo-latest-2.el7.noarch.rpm[root@Master ~]# yum -y install salt salt-cloud salt-master salt-minion salt-ssh salt-syndic[root@Minion ~]# yum -y install salt-minion 修改主控端配置文件，修改master地址和id 1234[root@Master ~]# sed -i '/^#master:/a master: 192.168.111.43' /etc/salt/minion[root@Master ~]# sed -i '/^#id:/a id: 192.168.111.43' /etc/salt/minion[root@Minion ~]# sed -i '/^#master:/a master: 192.168.111.43' /etc/salt/minion[root@Minion ~]# sed -i '/^#id:/a id: 192.168.111.45' /etc/salt/minion 启动salt-master和salt-minion 12[root@Master ~]# systemctl start salt-master &amp;&amp; systemctl start salt-minion &amp;&amp; systemctl enable salt-master &amp;&amp; systemctl enable salt-minion[root@Minion ~]# systemctl start salt-minion &amp;&amp; systemctl enable salt-minion 认证机制saltstack主控端是依靠openssl证书来与受控端主机认证通讯的，受控端启动后会发送给主控端一个公钥证书文件，在主控端用salt-key命令来管理证书。salt-minion与salt-master的认证过程： minion在第一次启动时，会在/etc/salt/pki/minion/下自动生成一对密钥，然后将公钥发给master master收到minion的公钥后，通过salt-key命令接受该公钥。此时master的/etc/salt/pki/master/minions目录将会存放以minion id命名的公钥，然后master就能对minion发送控制指令了 salt-key常用命令选项： -L 列出所有公钥信息 -a minion 接受指定minion等待认证的key -A 接受所有minion等待认证的key -r minion 拒绝指定minion等待认证的key -R 拒绝所有minion等待认证的key -f minion 显示指定key的指纹信息 -F 显示所有key的指纹信息 -d minion 删除指定minion的key -D 删除所有minion的key -y 自动回答yes查看并接受所有等待认证的key信息： 123456789[root@Master log]# salt-key -LAccepted Keys:Denied Keys:Unaccepted Keys:192.168.111.43192.168.111.45MasterMinionRejected Keys: 1234567891011[root@Master log]# salt-key -yAThe following keys are going to be accepted:Unaccepted Keys:192.168.111.43192.168.111.45MasterMinionKey for minion 192.168.111.43 accepted.Key for minion 192.168.111.45 accepted.Key for minion Master accepted.Key for minion Minion accepted. 123456789[root@Master log]# salt-key -L Accepted Keys:192.168.111.43192.168.111.45MasterMinionDenied Keys:Unaccepted Keys:Rejected Keys:]]></content>
      <categories>
        <category>devops</category>
      </categories>
      <tags>
        <tag>devops</tag>
        <tag>saltstack</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hello World]]></title>
    <url>%2F2019%2F07%2F18%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1hexo new "My New Post" More info: Writing Run server1hexo server More info: Server Generate static files1hexo generate More info: Generating Deploy to remote sites1hexo deploy More info: Deployment]]></content>
  </entry>
</search>
